
TRUNCATE TABLE "PRED_EXT"."PREDICTIONS";

INSERT INTO "PRED_EXT"."PREDICTIONS"(
		"LOAD_CYCLE_ID"
	,"LOAD_DATE"
	,"JRN_FLAG"
	,"RECORD_TYPE"
	,"DATUM"
	,"TIJD"
	,"POSTCODE"
	,"DATUM_BK"
	,"TIJD_BK"
	,"POSTCODE_FK_POSTCODE_BK"
	,"WERKENDEN"
	,"BELASTINGSPLICHTIGEN"
	,"GEMIDDELD_NETTO_BELASTBAAR_INKOMEN_PER_PERSOON"
	,"DICHTHEID"
	,"BIBLIOTHEEK_BEZOCHT"
	,"BOEK_GELEZEN"
	,"PARK_BEZOCHT"
	,"RESTAURANT_OF_CAFE_BEZOCHT"
	,"TELEVISIE_GEKEKEN"
	,"VOORSTELLING_BEZOCHT"
	,"SPORT_BEOEFEND"
	,"THEORETISCH_GESCHOOLDEN"
	,"AL_SO_GEEN_VERTRAGING"
	,"SCHOOL_BINNEN_ANTWERPEN"
	,"PLAATSEN_BUURTPARKINGS"
	,"PLAATSEN_FIETSENSTALLINGEN"
	,"PLAATSEN_VELO_STATIONS"
	,"OPP_SPORTTERREINEN"
	,"OPP_GEBRUIKSGROEN_EN_PLEINEN"
	,"OPP_SPEELTERREINEN"
	,"FIETS_PERCENTAGE"
)
SELECT 
		"LCI_SRC"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
	, "LCI_SRC"."LOAD_DATE" AS "LOAD_DATE"
	, "MEX_SRC"."ATTRIBUTE_VARCHAR" AS "JRN_FLAG"
	, "TDFV_SRC"."RECORD_TYPE" AS "RECORD_TYPE"
	, "TDFV_SRC"."DATUM" AS "DATUM"
	, "TDFV_SRC"."TIJD" AS "TIJD"
	, "TDFV_SRC"."POSTCODE" AS "POSTCODE"
	, COALESCE(UPPER( TO_CHAR("TDFV_SRC"."DATUM" , 'DD/MM/YYYY')),"MEX_SRC"."KEY_ATTRIBUTE_DATE") AS "DATUM_BK"
	, COALESCE(UPPER( TO_CHAR("TDFV_SRC"."TIJD" , 'HH24:MI:SS')),"MEX_SRC"."KEY_ATTRIBUTE_TIME") AS "TIJD_BK"
	, UPPER( TO_CHAR("TDFV_SRC"."POSTCODE" )) AS "POSTCODE_FK_POSTCODE_BK"
	, "TDFV_SRC"."WERKENDEN" AS "WERKENDEN"
	, "TDFV_SRC"."BELASTINGSPLICHTIGEN" AS "BELASTINGSPLICHTIGEN"
	, "TDFV_SRC"."GEMIDDELD_NETTO_BELASTBAAR_INKOMEN_PER_PERSOON" AS "GEMIDDELD_NETTO_BELASTBAAR_INKOMEN_PER_PERSOON"
	, "TDFV_SRC"."DICHTHEID" AS "DICHTHEID"
	, "TDFV_SRC"."BIBLIOTHEEK_BEZOCHT" AS "BIBLIOTHEEK_BEZOCHT"
	, "TDFV_SRC"."BOEK_GELEZEN" AS "BOEK_GELEZEN"
	, "TDFV_SRC"."PARK_BEZOCHT" AS "PARK_BEZOCHT"
	, "TDFV_SRC"."RESTAURANT_OF_CAFE_BEZOCHT" AS "RESTAURANT_OF_CAFE_BEZOCHT"
	, "TDFV_SRC"."TELEVISIE_GEKEKEN" AS "TELEVISIE_GEKEKEN"
	, "TDFV_SRC"."VOORSTELLING_BEZOCHT" AS "VOORSTELLING_BEZOCHT"
	, "TDFV_SRC"."SPORT_BEOEFEND" AS "SPORT_BEOEFEND"
	, "TDFV_SRC"."THEORETISCH_GESCHOOLDEN" AS "THEORETISCH_GESCHOOLDEN"
	, "TDFV_SRC"."AL_SO_GEEN_VERTRAGING" AS "AL_SO_GEEN_VERTRAGING"
	, "TDFV_SRC"."SCHOOL_BINNEN_ANTWERPEN" AS "SCHOOL_BINNEN_ANTWERPEN"
	, "TDFV_SRC"."PLAATSEN_BUURTPARKINGS" AS "PLAATSEN_BUURTPARKINGS"
	, "TDFV_SRC"."PLAATSEN_FIETSENSTALLINGEN" AS "PLAATSEN_FIETSENSTALLINGEN"
	, "TDFV_SRC"."PLAATSEN_VELO_STATIONS" AS "PLAATSEN_VELO_STATIONS"
	, "TDFV_SRC"."OPP_SPORTTERREINEN" AS "OPP_SPORTTERREINEN"
	, "TDFV_SRC"."OPP_GEBRUIKSGROEN_EN_PLEINEN" AS "OPP_GEBRUIKSGROEN_EN_PLEINEN"
	, "TDFV_SRC"."OPP_SPEELTERREINEN" AS "OPP_SPEELTERREINEN"
	, "TDFV_SRC"."FIETS_PERCENTAGE" AS "FIETS_PERCENTAGE"
FROM "PRED_DFV"."VW_PREDICTIONS" "TDFV_SRC"
INNER JOIN "PRED_MTD"."LOAD_CYCLE_INFO" "LCI_SRC" ON  1 = 1
INNER JOIN "PRED_MTD"."MTD_EXCEPTION_RECORDS" "MEX_SRC" ON  1 = 1
WHERE  "MEX_SRC"."RECORD_TYPE" = 'N'
;



 
 
